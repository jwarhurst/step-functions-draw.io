!function(t){var e={};function r(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",a=t[3];if(!a)return r;if(e&&"function"==typeof btoa){var n=(s=a,i=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(u," */")),o=a.sources.map((function(t){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(t," */")}));return[r].concat(o).concat([n]).join("\n")}var s,i,u;return[r].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,a){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(a)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(n[s]=!0)}for(var i=0;i<t.length;i++){var u=[].concat(t[i]);a&&n[u[0]]||(r&&(u[2]?u[2]="".concat(r," and ").concat(u[2]):u[2]=r),e.push(u))}},e}},function(t,e,r){var a=r(2),n=r(3);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var o={insert:"head",singleton:!1};a(n,o);t.exports=n.locals||{}},function(t,e,r){"use strict";var a,n=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},o=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),s=[];function i(t){for(var e=-1,r=0;r<s.length;r++)if(s[r].identifier===t){e=r;break}return e}function u(t,e){for(var r={},a=[],n=0;n<t.length;n++){var o=t[n],u=e.base?o[0]+e.base:o[0],l=r[u]||0,c="".concat(u," ").concat(l);r[u]=l+1;var p=i(c),d={css:o[1],media:o[2],sourceMap:o[3]};-1!==p?(s[p].references++,s[p].updater(d)):s.push({identifier:c,updater:f(d,e),references:1}),a.push(c)}return a}function l(t){var e=document.createElement("style"),a=t.attributes||{};if(void 0===a.nonce){var n=r.nc;n&&(a.nonce=n)}if(Object.keys(a).forEach((function(t){e.setAttribute(t,a[t])})),"function"==typeof t.insert)t.insert(e);else{var s=o(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var c,p=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function d(t,e,r,a){var n=r?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(t.styleSheet)t.styleSheet.cssText=p(e,n);else{var o=document.createTextNode(n),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function h(t,e,r){var a=r.css,n=r.media,o=r.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),o&&btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=a;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(a))}}var m=null,g=0;function f(t,e){var r,a,n;if(e.singleton){var o=g++;r=m||(m=l(e)),a=d.bind(null,r,o,!1),n=d.bind(null,r,o,!0)}else r=l(e),a=h.bind(null,r,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return a(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;a(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=n());var r=u(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var a=0;a<r.length;a++){var n=i(r[a]);s[n].references--}for(var o=u(t,e),l=0;l<r.length;l++){var c=i(r[l]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}r=o}}}},function(t,e,r){"use strict";r.r(e);var a=r(0),n=r.n(a)()(!1);n.push([t.i,"/* dark styling of the editor */\r\ndiv.jsoneditor,\r\ndiv.jsoneditor-menu {\r\n  border-color: #9c9c9c;\r\n}\r\ndiv.jsoneditor-menu {\r\n  background-color: #9c9c9c;\r\n}\r\n\r\n/* coloring of modal */\r\ndiv.jsoneditor-modal .pico-modal-header {\r\n  background-color: #9c9c9c;\r\n}\r\ndiv.jsoneditor-modal .jsoneditor-jmespath-label {\r\n  color: black;\r\n}\r\ndiv.jsoneditor-modal .jsoneditor-button-group.jsoneditor-button-group-value-asc input.jsoneditor-button-asc,\r\ndiv.jsoneditor-modal .jsoneditor-button-group.jsoneditor-button-group-value-desc input.jsoneditor-button-desc{\r\n  background-color: #357ae8;\r\n  background-image: linear-gradient(#4d90fe 0px,#357ae8 100%);\r\n  border: 1px solid #2f5bb7;\r\n  color: #fff;\r\n}\r\n\r\ndiv#jsoneditor.parameters {\r\n  height: 200px;\r\n  width: 100%;\r\n  overflow: auto;\r\n  resize: vertical;\r\n  padding: 0px 0px 10px 0px;\r\n}",""]),e.default=n},function(t,e,r){"use strict";let a;function n(t,e){return t&&t.value&&t.value.getAttribute&&t.value.getAttribute("type")=="awssf"+e}function o(t){return t&&null!=t.awssf&&t.value&&t.value.getAttribute&&t.value.getAttribute("type")&&0==t.value.getAttribute("type").indexOf("awssf")}function s(t){return n(t,"AWSconfig")}function i(t){return n(t,"Start")}function u(t){return n(t,"End")}function l(t){return t&&t.parent&&t.parent.awssf&&n(t.parent,"Parallel")}function c(t){return t&&t.parent&&t.parent.awssf&&n(t.parent,"Map")}function p(t){return n(t,"Parralel")}function d(t){return n(t,"Map")}function h(t){return n(t,"Task")}function m(t){return n(t,"Next")}function g(t){return n(t,"StartAt")}function f(t){return n(t,"Retry")}function b(t){return n(t,"Catch")}function A(t){return n(t,"Choice")}function y(t){return n(t,"Default")}function v(t,e){var r=mxUtils.createImage(e);return r.setAttribute("title",t.prototype.type),r.style.cursor="pointer",r.style.width="16px",r.style.height="16px",mxEvent.addGestureListeners(r,mxUtils.bind(this,(function(e){var r=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(e),mxEvent.getClientY(e)),a=t.prototype.create();this.graph.connectionHandler.start(this.state,r.x,r.y,new mxCellState(this.graph.view,a,this.graph.getCellStyle(a))),this.graph.isMouseDown=!0,this.graph.isMouseTrigger=mxEvent.isMouseEvent(e),mxEvent.consume(e)}))),r}function w(t){return t?!!t.match(/^\d+$/):null}function x(t){if(!t)return null;try{return JSON.parse(t),!0}catch(t){return!1}}function S(t){return t?!(!t.match(/^\$/)||t.match(/([@,:?[\]]|\.\.)/))||"null"==t:null}function E(t,e,r){return e||(e=[]),0==S(t.getAttribute("input_path"))&&e.push("input_path MUST use only supported jsonpath"),0==S(t.getAttribute("output_path"))&&e.push("output_path MUST use only supported jsonpath"),r&&0==S(t.getAttribute("result_path"))&&e.push("result_path MUST use only supported jsonpath or null"),e}function C(t){return(t=function(t){return(t=t.charAt(0).toLowerCase()+t.slice(1)).replace(/_./g,(function(t){return t.charAt(1).toUpperCase()}))}(t)).replace(/([A-Z])/g,(function(t){return"_"+t.charAt(0).toLowerCase()}))}var N;function T(t,e){if(null==e&&(e={}),"&&"==t.operator)Object.assign(e,{And:[T(t.left),T(t.right)]});else if("||"==t.operator)Object.assign(e,{Or:[T(t.left),T(t.right)]});else if("!"==t.operator)Object.assign(e,{Not:T(t.argument)});else if(N[t.operator]){var r,a=function t(e,r){return null==r&&(r=[]),"MemberExpression"==e.type?(e.computed?r.unshift("["+t(e.property)+"]"):r.unshift(t(e.property)),t(e.object,r)):"Identifier"==e.type?(r.unshift(e.name),r.reduce((t,e)=>"["==e[0]?t+e:t+"."+e)):"Literal"==e.type?e.value:void 0}(t.left),n=function(t){return t.value}(t.right);"number"==typeof n?r="Numeric":"string"==typeof n?r=n.match(/^["'][\d-]+T[\d:]+Z["']$/)?"Timestamp":"String":"boolean"==typeof n&&(r="Boolean");var o={Variable:a};o[r+N[t.operator]]=n,Object.assign(e,o)}return e}function M(t){return"null"===t?null:t}function R(){return"undefined"!=typeof __updateAWSconfig&&"undefined"!=typeof __describeStateMachine&&"undefined"!=typeof __listStateMachines&&"undefined"!=typeof __deployStateMachine}function O(){return R()}function U(){if(a.editor.graph.getModel().cells){var t=a.editor.graph.getModel().getRoot();t&&null==t.value&&(t.value=mxUtils.createXmlDocument().createElement("object"),null==t.getAttribute("type")&&t.setAttribute("type","awssfRoot"),null==t.getAttribute("name")&&t.setAttribute("name",""),null==t.getAttribute("comment")&&t.setAttribute("comment",""),null==t.getAttribute("timeout_seconds")&&t.setAttribute("timeout_seconds",""),null==t.getAttribute("version")&&t.setAttribute("version",""),null==t.getAttribute("role_arn")&&t.setAttribute("role_arn",""),null==t.getAttribute("state_machine_arn")&&t.setAttribute("state_machine_arn",""),t.awssf={})}}function k(){var t={},e=a.editor.graph.getModel(),r=null;for(var n in e.cells){var p=e.cells[n];o(p)&&(s(p)||l(p)||c(p)||(g(p)&&(r=e.cells[p.target.id].getAttribute("label")),i(p)||u(p)||p.isVertex()&&Object.assign(t,p.awssf.expJSON(p,e.cells))))}var d=e.getRoot(),h={};return d.getAttribute("comment")&&(h.Comment=d.getAttribute("comment")),r&&(h.StartAt=r),h.States=t,d.getAttribute("timeout_seconds")&&(h.TimeoutSeconds=Number(d.getAttribute("timeout_seconds"))),d.getAttribute("version")&&(h.Version=d.getAttribute("version")),h}function P(){var t=new mxCodec,e=a.editor.graph.getModel(),r=t.encode(e),n=mxUtils.findNode(r,"type","awssfAWSconfig");if(null==n)return!1;var o=t.decode(n),s={accessKeyId:o.getAttribute("accessKeyId"),secretAccessKey:o.getAttribute("secretAccessKey"),region:o.getAttribute("region")};return AWS.config.update(s),"undefined"!=typeof __updateAWSconfig&&__updateAWSconfig(s),!0}r.r(e),function(t){t["=="]="Equals",t["<"]="LessThan",t[">"]="GreaterThan",t["<="]="LessThanEquals",t[">="]="GreaterThanEquals"}(N||(N={}));const _={"arn:aws:states:::lambda:invoke":["ClientContext","FunctionName","InvocationType","Qualifier","Payload"],"arn:aws:states:::batch:submitJob":["ArrayProperties","ContainerOverrides","DependsOn","JobDefinition","JobName","JobQueue","Parameters","RetryStrategy","Timeout"],"arn:aws:states:::dynamodb:getItem":["Key","TableName","AttributesToGet","ConsistentRead","ExpressionAttributeNames","ProjectionExpression","ReturnConsumedCapacity"],"arn:aws:states:::dynamodb:putItem":["Item","TableName","ConditionalOperator","ConditionExpression","Expected","ExpressionAttributeNames","ExpressionAttributeValues","ReturnConsumedCapacity","ReturnItemCollectionMetrics","ReturnValues"],"arn:aws:states:::dynamodb:deleteItem":["Key","TableName","ConditionalOperator","ConditionExpression","Expected","ExpressionAttributeNames","ExpressionAttributeValues","ReturnConsumedCapacity","ReturnItemCollectionMetrics","ReturnValues"],"arn:aws:states:::dynamodb:updateItem":["Key","TableName","AttributeUpdates","ConditionalOperator","ConditionExpression","Expected","ExpressionAttributeNames","ExpressionAttributeValues","ReturnConsumedCapacity","ReturnItemCollectionMetrics","ReturnValues","UpdateExpression"],"arn:aws:states:::ecs:runTask":["Cluster","Group","LaunchType","NetworkConfiguration","Overrides","PlacementConstraints","PlacementStrategy","PlatformVersion","TaskDefinition"],"arn:aws:states:::sns:publish":["Message","MessageAttributes","MessageStructure","PhoneNumber","Subject","TargetArn","TopicArn"],"arn:aws:states:::sqs:sendMessage":["DelaySeconds","MessageAttribute","MessageBody","MessageDeduplicationId","MessageGroupId","QueueUrl"],"arn:aws:states:::glue:startJobRun":["JobName","JobRunId","Arguments","AllocatedCapacity","Timeout","SecurityConfiguration","NotificationProperty"],"arn:aws:states:::states:startExecution":["input","name","stateMachineArn"]};function D(t){var e=["arn:aws:states:::lambda:invoke","arn:aws:states:::lambda:invoke.waitForTaskToken","arn:aws:states:::batch:submitJob","arn:aws:states:::batch:submitJob.sync","arn:aws:states:::dynamodb:updateItem","arn:aws:states:::dynamodb:putItem","arn:aws:states:::dynamodb:getItem","arn:aws:states:::dynamodb:deleteItem","arn:aws:states:::ecs:runTask","arn:aws:states:::ecs:runTask.sync","arn:aws:states:::ecs:runTask.waitForTaskToken","arn:aws:states:::sns:publish","arn:aws:states:::sns:publish.waitForTaskToken","arn:aws:states:::sqs:sendMessage","arn:aws:states:::sqs:sendMessage.waitForTaskToken","arn:aws:states:::glue:startJobRun","arn:aws:states:::glue:startJobRun.sync","arn:aws:states:::sagemaker:createEndpoint","arn:aws:states:::sagemaker:createEndpoint.sync","arn:aws:states:::sagemaker:createEndpointConfig","arn:aws:states:::sagemaker:createEndpointConfig.sync","arn:aws:states:::sagemaker:createHyperParameterTuningJob","arn:aws:states:::sagemaker:createHyperParameterTuningJob.sync","arn:aws:states:::sagemaker:createLabelingJob","arn:aws:states:::sagemaker:createLabelingJob.sync","arn:aws:states:::sagemaker:createModel","arn:aws:states:::sagemaker:createModel.sync","arn:aws:states:::sagemaker:createTrainingJob","arn:aws:states:::sagemaker:createTrainingJob.sync","arn:aws:states:::sagemaker:createTransformJob","arn:aws:states:::sagemaker:createTransformJob.sync","arn:aws:states:::sagemaker:updateEndpoint","arn:aws:states:::sagemaker:updateEndpoint.sync","arn:aws:states:::elasticmapreduce:createCluster","arn:aws:states:::elasticmapreduce:createCluster.sync","arn:aws:states:::elasticmapreduce:setClusterTerminationProtection","arn:aws:states:::elasticmapreduce:terminateCluster","arn:aws:states:::elasticmapreduce:terminateCluster.sync","arn:aws:states:::elasticmapreduce:addStep.sync","arn:aws:states:::elasticmapreduce:cancelStep","arn:aws:states:::elasticmapreduce:modifyInstanceFleetByName","arn:aws:states:::elasticmapreduce:modifyInstanceGroupByName","arn:aws:states:::states:startExecution","arn:aws:states:::states:startExecution.sync","arn:aws:states:::states:startExecution.waitForTaskToken"];if(!P())return t(e);new AWS.Lambda({apiVersion:"2015-03-31"}).listFunctions({},(function(r,a){if(r)console.log(r,r.stack);else{for(var n in a.Functions){var o=a.Functions[n];e.push(o.FunctionArn)}t(e)}}))}const I=function(t,e){const r=t.editor.graph;function a(t){var e;e="{"===t[0]?JSON.parse(t.trim()):jsyaml.load(t.trim());var a=r.getModel().getRoot();a.setAttribute("comment",e.Comment||""),a.setAttribute("timeout_seconds",e.TimeoutSeconds||""),a.setAttribute("version",e.Version||"");var n=function t(e){const r={hash:{},list:[]};let a;for(const n in e){const o=e[n];if("Pass"===o.Type)a=PassState.prototype.create(n,o);else if("Task"===o.Type)a=TaskState.prototype.create(n,o);else if("Choice"===o.Type)a=ChoiceState.prototype.create(n,o);else if("Wait"===o.Type)a=WaitState.prototype.create(n,o);else if("Succeed"===o.Type)a=SucceedState.prototype.create(n,o);else if("Fail"===o.Type)a=FailState.prototype.create(n,o);else if("Parallel"===o.Type){a=ParallelState.prototype.create(n,o);for(const e in o.Branches){const n=t(o.Branches[e].States);for(const t of n.list)a.insert(t);Object.assign(r.hash,n.hash)}}else if("Map"===o.Type){a=MapState.prototype.create(n,o);const e=t(o.Iterator.States);for(const t of e.list)a.insert(t);Object.assign(r.hash,e.hash)}r.hash[n]=a,r.list.push(a)}return r}(e.States),o=n.list,s=n.hash,i=StartPoint.prototype.create();o.unshift(i);var u=EndPoint.prototype.create();o.push(u);var l=function t(e,r,a,n){var o,s=[];for(var i in e.StartAt&&a&&((o=StartAtEdge.prototype.create()).source=a,o.target=r[e.StartAt],s.push(o)),e.States){var u=e.States[i];if(u.Default&&r[u.Default]&&(o=DefaultEdge.prototype.create("Default",r[i],r[u.Default]),s.push(o)),u.Next&&r[u.Next]&&(o=NextEdge.prototype.create("Next",r[i],r[u.Next]),s.push(o)),(u.End||u.Type&&u.Type.match(/(Succeed|Fail)/))&&n&&(o=NextEdge.prototype.create("Next",r[i],n),s.push(o)),u.Retry)for(const t in u.Retry)o=RetryEdge.prototype.create("Retry",r[i],u.Retry[t],u.Retry.length-Number(t)),s.push(o);if(u.Catch&&u.Catch.length>0)for(const t in u.Catch)o=CatchEdge.prototype.create("Catch",r[i],r[u.Catch[t].Next],u.Catch[t],u.Catch.length-Number(t)),s.push(o);if(u.Choices&&u.Choices.length>0)for(const t in u.Choices)o=ChoiceEdge.prototype.create("Choice",r[i],r[u.Choices[t].Next],u.Choices[t],u.Choices.length-Number(t)),s.push(o);if("Parallel"===u.Type)for(const e of u.Branches){const a=r[i].getChildAt(0);t(e,r,a).map(t=>r[i].insert(t))}if("Map"===u.Type){const e=r[i].getChildAt(0);t(u.Iterator,r,e).map(t=>r[i].insert(t))}}return s}(e,s,i,u);o.push(...l),r.getModel().beginUpdate();try{r.addCells(o),r.fireEvent(new mxEventObject("cellsInserted","cells",o))}finally{r.getModel().endUpdate()}return o}var n=document.createElement("div"),o=document.createElement("h2");mxUtils.write(o,e),o.style.marginTop="0px",o.style.marginBottom="24px",n.appendChild(o);var s=document.createElement("span");mxUtils.write(s,"Paste statemachine definition JSON or YAML"),n.appendChild(s);var i=new mxForm("properties");i.table.style.width="100%",i.table.style.paddingRight="20px";var u="",l=i.addTextarea("",u,25);l.style.width="100%",l.style.marginBottom="16px",n.appendChild(i.table);var c=new mxForm("properties");c.table.style.width="100%",c.table.style.paddingRight="20px";var p=document.createElement("colgroup");p.width="120",c.table.insertBefore(p,c.body);var d=document.createElement("colgroup");c.table.insertBefore(d,c.body);var h=document.createElement("select");if(c.addField("StateMachine:",h),R()&&P())__listStateMachines().then((function(t){for(var e in t.stateMachines){var r=document.createElement("option");mxUtils.writeln(r,t.stateMachines[e].name),r.setAttribute("value",t.stateMachines[e].stateMachineArn),h.appendChild(r)}})),mxEvent.addListener(h,"change",(function(){__describeStateMachine(h.value).then((function(t){0!=l.value.length&&l.value!=u||(u=t.definition,l.value=u)}))}));else{var m=document.createElement("option");mxUtils.writeln(m,"Select a StateMachine..."),h.appendChild(m),h.disabled=!0}n.appendChild(c.table);var g=document.createElement("div");g.style.marginTop="18px",g.style.textAlign="right",this.init=function(){l.focus()};var f=mxUtils.button(mxResources.get("cancel"),(function(){l.value==u?t.hideDialog():t.confirm(mxResources.get("areYouSure"),(function(){t.hideDialog()}))}));f.className="geBtn",t.editor.cancelFirst&&g.appendChild(f);var b=mxUtils.button(mxResources.get("awssfImportBtn"),(function(){try{var e=a(l.value);t.hideDialog(),function(t){r.setSelectionCells(t),r.getModel().beginUpdate();try{var e=t.filter((function(t){return t.awssf.type.match(/Parallel|Map/)})),a=new mxCompactTreeLayout(r,!1);for(var n in a.edgeRouting=!1,a.levelDistance=30,a.groupPadding=30,e)a.execute(e[n],e[n].getChildAt(0));var o=new mxHierarchicalLayout(r,mxConstants.DIRECTION_NORTH);o.intraCellSpacing=40,o.interRankCellSpacing=40,o.interHierarchySpacing=40,o.parallelEdgeSpacing=10,o.execute(r.getDefaultParent(),[t[0]])}finally{var s=new mxMorphing(r);s.addListener(mxEvent.DONE,mxUtils.bind(this,(function(){r.getModel().endUpdate()}))),s.startAnimation()}}(e)}catch(t){alert(t)}}));g.appendChild(b),b.className="geBtn gePrimaryBtn",t.editor.cancelFirst||g.appendChild(f),n.appendChild(g),this.container=n},B=function(t,e){var r=t.editor.graph,a={definition:JSON.stringify(k(),null,"  "),name:r.getModel().cells[0].getAttribute("name")||"",roleArn:r.getModel().cells[0].getAttribute("role_arn")||"",stateMachineArn:r.getModel().cells[0].getAttribute("state_machine_arn")||""},n=document.createElement("div"),o=document.createElement("h2");mxUtils.write(o,e),o.style.marginTop="0px",o.style.marginBottom="24px",n.appendChild(o);var s=new mxForm("properties");s.table.style.width="100%",s.table.style.paddingRight="20px";var i=document.createElement("colgroup");i.width="120",s.table.insertBefore(i,s.body);var u=document.createElement("colgroup");s.table.insertBefore(u,s.body);var l=document.createElement("select"),c=document.createElement("option");mxUtils.writeln(c,"Create a new statemachine"),c.setAttribute("selected","true"),l.appendChild(c),c.setAttribute("value","__CREATE__"),__listStateMachines().then((function(t){for(var e in t.stateMachines){var r=document.createElement("option");mxUtils.writeln(r,t.stateMachines[e].name),r.setAttribute("value",t.stateMachines[e].stateMachineArn),a.stateMachineArn==t.stateMachines[e].stateMachineArn&&r.setAttribute("selected","true"),l.appendChild(r)}})),s.addField("StateMachine:",l),mxEvent.addListener(l,"change",(function(){__describeStateMachine(l.value).then((function(t){0!=g.value.length&&g.value!=m||(p.value=t.stateMachineArn,d.value=t.name,h.value=t.roleArn)}))}));var p=s.addText("StaeMachineArn:",a.stateMachineArn);p.style.width="100%";var d=s.addText("Name:",a.name);d.style.width="100%";var h=s.addText("Role:",a.roleArn);h.style.width="100%";var m=a.definition,g=s.addTextarea("Definition:",m,30);g.style.width="100%",n.appendChild(s.table);var f=document.createElement("div");f.style.marginTop="18px",f.style.textAlign="right",this.init=function(){d.focus()};var b=mxUtils.button(mxResources.get("cancel"),(function(){g.value==m?t.hideDialog():t.confirm(mxResources.get("areYouSure"),(function(){t.hideDialog()}))}));b.className="geBtn",t.editor.cancelFirst&&f.appendChild(b);var A=mxUtils.button(mxResources.get("awssfDeployBtn"),(function(){var e={name:d.value,definition:g.value,roleArn:h.value};"__CREATE__"!==l.value&&(e.stateMachineArn=p.value,delete e.name,e.roleArn||delete e.roleArn,e.definition||delete e.definition),__deployStateMachine(e).then(()=>{t.hideDialog()}).catch(t=>{alert(t.message)})}));f.appendChild(A),A.className="geBtn gePrimaryBtn",t.editor.cancelFirst||f.appendChild(b),n.appendChild(f),this.container=n},j=function(t,e,r){var a=document.createElement("div"),n=document.createElement("h2");mxUtils.write(n,e),n.style.marginTop="0px",n.style.marginBottom="24px",a.appendChild(n);var o=new mxForm("properties");o.table.style.width="100%",o.table.style.paddingRight="20px";var s=o.addTextarea("",r,25);s.style.width="100%",s.style.marginBottom="16px",s.readOnly=!0,a.appendChild(o.table);var i=document.createElement("div");i.style.marginTop="18px",i.style.textAlign="right",this.init=function(){s.focus(),s.scrollTop=0};var u=mxUtils.button(mxResources.get("copy"),(function(){const t=document.createRange();t.selectNode(s);const e=document.getSelection();e.removeAllRanges(),e.addRange(t),document.execCommand("copy"),t.detach()}));u.className="geBtn gePrimaryBtn",i.appendChild(u);var l=mxUtils.button(mxResources.get("close"),(function(){t.hideDialog()}));l.className="geBtn",i.appendChild(l),a.appendChild(i),this.container=a};let J;function F(){var t=J.editor.graph.getSelectionCell()||J.editor.graph.getModel().getRoot();if(null!=t){var e=new EditDataDialog(J,t);J.showDialog(e.container,600,500,!0,!1),e.container.parentNode.style.resize="both",e.init()}}function L(t,e){var r=new j(J,t,e);J.showDialog(r.container,700,500,!0,!1),r.container.parentNode.style.resize="both",r.init()}function H(){var t={START_EXIST:[!1,"start MUST exist"],END_EXIST:[!1,"end MUST exist"],UNIQ_NAME:[!0,{},"name MUST be unique."],NAME_LENGTH:[!0,[],"name MUST BE less than or equal to 128 unicode characters."]},e=J.editor.graph.getModel();for(const n in e.cells){const o=e.cells[n];if(o.awssf&&o.awssf.validate){var r=o.awssf.validate(o);r.length>0?(t[a]=[!1,[],r.join("\n")],J.editor.graph.setCellWarning(o,r.join("\n"))):J.editor.graph.setCellWarning(o,null)}if(o.isVertex()){var a=o.getAttribute("label");null==a||i(o)||u(o)||(t.UNIQ_NAME[1][a]>=1?(t.UNIQ_NAME[0]=!1,t.UNIQ_NAME[1][a]+=1):t.UNIQ_NAME[1][a]=1,a.length>128&&(t.NAME_LENGTH[0]=!1,t.NAME_LENGTH[1].push(a))),null!=o.value&&(i(o)&&(t.START_EXIST[0]=!0),u(o)&&(t.END_EXIST[0]=!0))}}var n=[];for(const e in t)0==t[e][0]&&n.push(t[e][t[e].length-1]);n.length>0&&mxUtils.alert(n.join("\n"))}function V(){var t=k();L("Export as JSON",JSON.stringify(t,null,"  "))}function W(){var t=k();L("Export as YAML",jsyaml.dump(t))}function Y(){var t=(new mxCodec).encode(J.editor.graph.getModel());L("Export as XML for draw.io",mxUtils.getPrettyXml(t))}function q(){var t=new I(J,"Import Definition");J.showDialog(t.container,700,500,!0,!1),t.container.parentNode.style.resize="both",t.init()}function G(){if(R()&&P()){var t=new B(J,"Deploy StateMachine Definition");J.showDialog(t.container,800,600,!0,!1),t.container.parentNode.style.resize="both",t.init()}}const K=mxGraph.prototype.createEdge;mxGraph.prototype.createEdge=function(t,e,r,a,n,s){return o(a)&&a.awssf.createDefaultEdge?a.awssf.createDefaultEdge(a):K.apply(this,arguments)};const X=mxConnectionHandler.prototype.createEdgeState;mxConnectionHandler.prototype.createEdgeState=function(t){var e=this.previous.cell;if(o(e)&&e.awssf.createDefaultEdge){var r=e.awssf.createDefaultEdge(e);return r?new mxCellState(this.graph.view,r,this.graph.getCellStyle(r)):null}return X.apply(this,arguments)};const z=mxConnectionHandler.prototype.insertEdge;function Q(t){!function(t){const e=t.editor.graph.createHandler;t.editor.graph.createHandler=function(t){return null!=t&&1==this.getSelectionCells().length&&o(t.cell)&&t.cell.awssf.handler?new t.cell.awssf.handler(t):e.apply(this,arguments)}}(t),function(t){const e=t.editor.graph.getModel().cellAdded;t.editor.graph.getModel().cellAdded=function(t){if(!o(t))return e.apply(this,arguments);var r={};for(const t in this.cells){const e=this.cells[t];if(e.isVertex()&&e.getAttribute("label")){var a=e.getAttribute("label");r[a]?r[a].push(e):r[a]=[e]}}var n=t.getAttribute("label");if(t.isVertex()&&r[n]&&!i(t)&&!u(t)){for(var s=2,l=n.replace(/(\d*)$/,s);r[l];)s++,l=n.replace(/(\d*)$/,s);t.setAttribute("label",l)}return U(),e.apply(this,arguments)}}(t)}var Z;function tt(t,e){var r=new mxObjectCodec(new e);r.encode=function(e,r){try{var a=e.document.createElement(t)}catch(t){console.log("encode error",t)}return a},r.decode=function(t,r,a){return new e},mxCodecRegistry.register(r)}function et(){var t=mxUtils.createImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAACpklEQVRIS7VVMU9TURg9nWiZoF0k1MQmlKCREhhowUHaScpWdYHoINUORoKTiT+AhMnE6IDigraL2g10amGhxaFGMJHQJiWxBJcWJl6Zas4H9/leH4VKwl2a13vv+c73nfN911ar1Wq4oGVrBpzxq9VDnYLd3gKbzXYmpabAs2s5bBWKCAwOIPstJ7/dXs/5wNMrGfh6e+BytgvA4pcU3J0d6PNdRWp5FZpWxdhoSPbKlT2sb2wieHPIEszC/H08iQNNQ6m0i1DwBhwOu4BPP3kgwUo7u+CZ4MiwBMlkc3C52tDqcODeRMQUwAROVvlCEbHohFz8mFyUw2SpsuA3A/AsAblHAnPzcXi7PAiNDOsBTOBMce5tAk+nJuWCceUL2/qnt+uKaY9EXrx8h9jDcRMJS1nIqFLZx51IWAB+rP+SsjB11p2sy+V9YUwNuD4ll+B0tplY838LuHLG/YnbOnA9I5WhCrAQ/4zuLg8C/gFrzenjjZ+bKO38QWYtp4s3M/vakqq6rQI8f/ZYHPNmPoE+3zW4Oy+h93qP9IEwV+Ixutfrkbpt5YtIr6yKuI0W60z29DwD5PNF6Ye7kTHRTAf/Xdo1NQbB6Rzl55MCUAs6xNhQvHfZ3WEGpyhkTSecm3lhW9jTDDpz1pxdRifQHUrA/6k5LUz30FHsbr3mxpTr3bL0NYVHUbN/lYDhW0d2PNUtRvDGPm+XWlKbcnnP5POmwE/rUAqlVv1EpNtmZl9hemqycYcezZZtxKLjMlsoMld4NGiZLenljIj2b7YkxAwNZwuBmKKmHUrqAX8/WtVUPGZF0Rc+JBEaGcKBVkV27TtcrnY4HC1gVxvXiY8FM6BQzcxzBmPJjIxVgKZfIpaLs4Nu8g/2n/8lqu/GC31DGw6XMzb+An4I4cvYKbPGAAAAAElFTkSuQmCC");return t.setAttribute("title","Settings"),t.style.cursor="pointer",t.style.width="16px",t.style.height="16px",t}mxConnectionHandler.prototype.insertEdge=function(t,e,r,a,n,s){var i=null;if(!o(a))return z.apply(this,arguments);if((l(a)||l(n))&&a.parent!=n.parent)return null;if((c(a)||c(n))&&a.parent!=n.parent)return null;if(a==n&&(h(a)||p(a)||d(a)))i=RetryEdge.prototype.create();else if(this.edgeState)i=this.edgeState.cell;else{if(!a.awssf||!a.awssf.createDefaultEdge)return null;i=a.awssf.createDefaultEdge(a)}return null!=i?i=this.graph.addEdge(i,t,a,n):null};const rt=function(t){mxVertexHandler.apply(this,arguments)};(rt.prototype=new mxVertexHandler).constructor=rt,rt.prototype.domNode=null,rt.prototype.init=function(){mxVertexHandler.prototype.init.apply(this,arguments),this.domNode=document.createElement("div"),this.domNode.style.position="absolute",this.domNode.style.whiteSpace="nowrap",this.custom&&this.custom.apply(this,arguments);var t=et();mxEvent.addGestureListeners(t,mxUtils.bind(this,(function(t){mxEvent.consume(t)}))),mxEvent.addListener(t,"click",mxUtils.bind(this,(function(t){Z.actions.get("editData").funct(),mxEvent.consume(t)}))),this.domNode.appendChild(t),this.graph.container.appendChild(this.domNode),this.redrawTools()},rt.prototype.redraw=function(){mxVertexHandler.prototype.redraw.apply(this),this.redrawTools()},rt.prototype.redrawTools=function(){if(null!=this.state&&null!=this.domNode){var t=mxClient.IS_VML&&"CSS1Compat"==document.compatMode?20:4;this.domNode.style.left=this.state.x+this.state.width-14*this.domNode.children.length+"px",this.domNode.style.top=this.state.y+this.state.height+t+"px"}},rt.prototype.destroy=function(t,e){mxVertexHandler.prototype.destroy.apply(this,arguments),null!=this.domNode&&(this.domNode.parentNode.removeChild(this.domNode),this.domNode=null)};const at=function(t){mxEdgeHandler.apply(this,arguments)};function nt(t,e,r,a){var n=e||t.type;r||(r="rounded=1;whiteSpace=wrap;html=1;gradientColor=none;dashed=1"),a||(a={});var o=new mxGeometry(0,0,80,40),s=new mxCell(n,o,r);return s.vertex=!0,s.value=mxUtils.createXmlDocument().createElement("object"),s.setAttribute("label",n),s.setAttribute("type","awssf"+t.type),s.setAttribute("comment",a.Comment||""),t.type.match(/Fail/)||(s.setAttribute("input_path",a.InputPath||""),s.setAttribute("output_path",a.OutputPath||"")),t.type.match(/Pass|Task|Parallel|Map/)&&(s.setAttribute("parameters",JSON.stringify(a.Parameters)||""),s.setAttribute("result_path",a.ResultPath||"")),t.type.match(/Task|Parallel|Map/)&&(s.setAttribute("results_selector",JSON.stringify(a.ResultsSelector)||""),s.setAttribute("result_path",a.ResultPath||"")),s.awssf=t,s}function ot(t,e){var r=t.type;null==e&&(e=new mxGeometry(0,0,40,40));var a=new mxCell(r,e,"ellipse;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;");return a.vertex=!0,a.value=mxUtils.createXmlDocument().createElement("object"),a.setAttribute("label",r),a.setAttribute("type","awssf"+r),a.awssf=t,a}function st(t,e,r,a,n,o){var s=new mxCell(e,new mxGeometry(0,0,60,60),r);return s.geometry.setTerminalPoint(new mxPoint(0,0),!0),s.geometry.setTerminalPoint(new mxPoint(s.geometry.width,s.geometry.height),!1),s.geometry.relative=!0,s.edge=!0,s.value=mxUtils.createXmlDocument().createElement("object"),s.setAttribute("label",e),s.setAttribute("type","awssf"+t.type),s.awssf=t,a&&n&&(s.source=a,s.target=n),s}(at.prototype=new mxEdgeHandler).constructor=at,at.prototype.domNode=null,at.prototype.init=function(){mxEdgeHandler.prototype.init.apply(this,arguments),this.domNode=document.createElement("div"),this.domNode.style.position="absolute",this.domNode.style.whiteSpace="nowrap",this.custom&&this.custom.apply(this,arguments);var t=et();mxEvent.addGestureListeners(t,mxUtils.bind(this,(function(t){mxEvent.consume(t)}))),mxEvent.addListener(t,"click",mxUtils.bind(this,(function(t){Z.actions.get("editData").funct(),mxEvent.consume(t)}))),this.domNode.appendChild(t),this.graph.container.appendChild(this.domNode),this.redrawTools()},at.prototype.redraw=function(){mxEdgeHandler.prototype.redraw.apply(this),this.redrawTools()},at.prototype.redrawTools=function(){if(null!=this.state&&null!=this.domNode){mxClient.IS_VML&&document.compatMode;this.domNode.style.left=this.labelShape.bounds.x+this.labelShape.bounds.width+"px",this.domNode.style.top=this.labelShape.bounds.y+"px"}},at.prototype.destroy=function(t,e){mxEdgeHandler.prototype.destroy.apply(this,arguments),null!=this.domNode&&(this.domNode.parentNode.removeChild(this.domNode),this.domNode=null)};const it=function(){};(it.prototype=new mxSwimlane).constructor=it,it.prototype.isHorizontal=function(){return!1},it.prototype.paintVertexShape=function(t,e,r,a,n){t.translate(e,r);var o=Math.max(0,Math.min(a,parseFloat(mxUtils.getValue(this.style,"dx",this.dx))));o=Math.min(.5*a,.5*n,o),t.begin(),t.moveTo(a-.5*o,o),t.lineTo(a,o),t.lineTo(a,n),t.lineTo(o,n),t.lineTo(o,n-.5*o),t.lineTo(a-.5*o,n-.5*o),t.close(),t.fillAndStroke(),t.begin(),t.moveTo(a-o,.5*o),t.lineTo(a-.5*o,.5*o),t.lineTo(a-.5*o,n-.5*o),t.lineTo(.5*o,n-.5*o),t.lineTo(.5*o,n-o),t.lineTo(a-o,n-o),t.close(),t.fillAndStroke(),t.begin(),t.moveTo(0,0),t.lineTo(a-o,0),t.lineTo(a-o,n-o),t.lineTo(0,n-o),t.close(),t.stroke(),t.begin(),t.moveTo(0,this.startSize),t.lineTo(a-o,this.startSize),t.stroke()},mxCellRenderer.registerShape("awssf.layered",it),Graph.handleFactory["awssf.layered"]=function(t){var e=[];return e.push(...Graph.handleFactory.swimlane(t)),e};const ut=function(){};ut.prototype.create=function(){return t=this,(e=new mxCell("AWSconfig",new mxGeometry(0,0,70,46),"dashed=0;html=1;shape=mxgraph.aws2.non-service_specific.cloud;strokeColor=none;verticalLabelPosition=bottom;verticalAlign=top;")).vertex=!0,e.value=mxUtils.createXmlDocument().createElement("object"),e.setAttribute("label","config"),e.setAttribute("type","awssfAWSconfig"),e.setAttribute("accessKeyId",""),e.setAttribute("secretAccessKey",""),e.setAttribute("region",""),e.awssf=t,e;var t,e},ut.prototype.handler=rt,tt("AWSconfig",ut);const lt=function(){};lt.prototype.type="Choice",lt.prototype.create=function(t,e){e||(e={});var r=nt(this,t,"shape=stencil(rZZNT4QwEIZ/DddNodmgR8Pi0YsHzl12VpqFlrS46r+3UIl8FNOhJhzgHWaezvBSiGimK9ZClBDBGojoKUqSE5RccynMqdGZbqHsbOTOFGfnGmxEd0re4INfusqGuahA8a6P0jwiT+ae/qBZKYUwRUxNPYtM4qYY48Lkkk9bjBzio+V8/Qj2qjWIBjpQM/V39S9FMUjPCBIl+0ho0L6O0Jh0Xz85GvSwr6EcT1qYIfYjvYabwZsUaAZfTqgZfDnBZvAG4UkkXfjukBz9aAX6ZVqAfDn/0FPqy8J74jHZO8AcO8B43wDxplj35DvA3DVAmhll68NFszMrb29KvouLc4kt6z+Kq8AYbuQdJiNy7aKu1sf0motJunMT9k+Pydzjx0D+WA+xgtAC6AbKWmrYspfRV49vUDeeOc2uUsEfZrjyurY/S06TrbIH1f6XDcI3);whiteSpace=wrap;html=1;gradientColor=none;dashed=1",e);return r.setAttribute("choices",""),r.setAttribute("default",""),r},lt.prototype.hiddenAttributes=["choices","default"],lt.prototype.createDefaultEdge=function(){return ChoiceEdge.prototype.create()},lt.prototype.validate=function(t,e){return e||(e=[]),t.edges&&0!=t.edges.filter((function(e){return e.source==t&&A(e)})).length||e.push("A Choice state MUST have more than one choice edge"),E(t,e,!1)},lt.prototype.expJSON=function(t,e){var r={},a=t.getAttribute("label");if(r[a]={Type:"Choice",Choices:[]},t.getAttribute("comment")&&(r[a].Comment=t.getAttribute("comment")),t.getAttribute("input_path")&&(r[a].InputPath=M(t.getAttribute("input_path"))),t.getAttribute("output_path")&&(r[a].OutputPath=M(t.getAttribute("output_path"))),t.edges){var n=t.edges.sort((function(t,e){return Number(t.getAttribute("weight"))>Number(e.getAttribute("weight"))?-1:Number(t.getAttribute("weight"))<Number(e.getAttribute("weight"))?1:0}));for(var o in n){var s=n[o];s.source==t&&(A(s)?r[a].Choices.push(s.awssf.expJSON(s,e)):y(s)&&Object.assign(r[a],s.awssf.expJSON(s,e)))}}return r},tt("ChoiceState",lt);var ct=function(t){this.custom=function(){this.domNode.appendChild(ChoiceEdge.prototype.createHandlerImage.apply(this,arguments)),this.domNode.appendChild(DefaultEdge.prototype.createHandlerImage.apply(this,arguments))},rt.apply(this,arguments)};lt.prototype.handler=ct,mxUtils.extend(ct,rt);const pt=function(){};pt.prototype.type="StartAt",pt.prototype.create=function(t,e,r){return null==t&&(t=this.type),st(this,t,"endArrow=classic;html=1;strokeColor=#000000;strokeWidth=1;fontSize=12;",e,r)},pt.prototype.validate=function(t,e){return e||(e=[]),t.source&&t.target||e.push("edge MUST be connected"),e},pt.prototype.expJSON=function(t,e){return null!=t.target?{StartAt:e[t.target.id].getAttribute("label")}:{}},pt.prototype.handler=at,tt("StartAtEdge",pt);const dt=function(){};dt.prototype.type="Next",dt.prototype.create=function(t,e,r){return null==t&&(t=this.type),st(this,t,"endArrow=classic;html=1;strokeColor=#000000;strokeWidth=1;fontSize=12;",e,r)},dt.prototype.validate=function(t,e){return e||(e=[]),t.source&&t.target||e.push("edge MUST be connected"),e},dt.prototype.expJSON=function(t,e){return null!=t.target?{Next:e[t.target.id].getAttribute("label")}:{}},dt.prototype.createHandlerImage=function(){return v.call(this,dt,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAAB30lEQVRIS72VsU4CQRRFj52ddCZU0tpo4h/YYKkUNhRCYgyJhfIFakNjoR9goiiJiY12kBBsaSDRL9A/EBtojJjLZNhlnIVdjU612Z097819d96bGw6HQ/5ozcWBv77C8zM8PcHqKqyswNLS7Iwi4b0elMvw8AB6dlcqBZubcHYGevYtL1zAYtEP9QW5vDSB3PUNXihAtTr7yO6OgwM4P598OwFXxltbycH2j/v7yROM4dI1kwmkWF+H62v4/ASd5vExCHpxAdvbsL8PNzfBe2n/8hLUYAx35bDwdBqaTchmZ8O1Y2cHrq7M3jFcUd/fA4CFDwagAKencHxsvkdlrm/ivL2F4PKxJAkvC2+1YG0NFhZgbw/q9elwMSSN7sEoc18hLbzRgG4XKhXodCCXM972ae4WdgTXcU9O/JkLvrsLtZpxkuy2uDgdfnRkJIyVueDLy3B3Z+Rpt2Fj47tbvJlP09xmrh9LJSPPxwfMz0fDJzS3Vfa5JQzXPt3efB76fT9cJ7O9aKbPXbjkub017nIvUaTPFU32CWeftBEoa0lsu+T/9Bab5U+7orVf+LSR/VxB4kgkKdRLYvVzG1k1ODw0k8gXRFABdakSTSK3kCqS5qedoZqjv5qhSZ3i2/8FknYly43Hp8kAAAAASUVORK5CYII=")},dt.prototype.handler=at,tt("NextEdge",dt);const ht=function(){};ht.prototype.type="Retry",ht.prototype.create=function(t,e,r,a){null==t&&(t=this.type),r||(r={ErrorEquals:"",InterValSeconds:1,MaxAttempts:3,BackoffRate:2});var n=st(this,t,"edgeStyle=orthogonalEdgeStyle;curved=1;html=1;exitX=0.5;exitY=1;entryX=1;entryY=0.5;startArrow=none;startFill=0;jettySize=auto;orthogonalLoop=1;strokeColor=#000000;strokeWidth=1;fontSize=12;",e,e);return n.geometry.setTerminalPoint(new mxPoint(0,n.geometry.height),!0),n.geometry.setTerminalPoint(new mxPoint(n.geometry.width,0),!1),n.setAttribute("placeholders",1),n.setAttribute("error_equals",r.ErrorEquals||""),n.setAttribute("interval_seconds",r.IntervalSeconds||""),n.setAttribute("max_attempts",r.MaxAttempts||""),n.setAttribute("backoff_rate",r.BackoffRate||""),n.setAttribute("weight",a||1),n},ht.prototype.validate=function(t,e){return e||(e=[]),t.source&&t.target||e.push("edge MUST be connected"),t.source&&t.target&&t.source.id!=t.target.id&&e.push("retry edge target MUST be self"),0==w(t.getAttribute("interval_seconds"))&&e.push("interval_seconds MUST be a positive integer"),0==w(t.getAttribute("max_attempts"))&&e.push("max_attempts MUST be greater than or equal to 0"),0==w(t.getAttribute("backoff_rate"))&&Number(t.getAttribute("backoff_rate"))>=1&&e.push("backoff_rate MUST be greater than or equal to 1.0"),e},ht.prototype.expJSON=function(t,e){var r=t.getAttribute("error_equals");return r=r?r.split(/,\s*/):[],null!=t.target?{ErrorEquals:r,IntervalSeconds:Number(t.getAttribute("interval_seconds")),MaxAttempts:Number(t.getAttribute("max_attempts")),BackoffRate:Number(t.getAttribute("backoff_rate"))}:{}},ht.prototype.createHandlerImage=function(){return v.call(this,ht,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAACCUlEQVRIS7WVTUhUURTHf7NRN+JsUkER3UUI5kJMIoqBMNzkR6C7Elq5UReh0sIkgsCF0yJw5wdi2MYPEAyxLAhcuNBcFKLM4EJ0oU5I+FF648zzNe++d5/MM72rx7vn/M///s9XSCmlOO/EE7C8DUtbcDMfyvKgOHyui30ZMoInDqH9A0z8APl2n3AW1F6HvmqQb5/jBRfA5kkzqCnIwEMrkOHo4E8mYGg5rSdrRq2VEH3g8UuBC+O6seDAtsd4o+cFFrjoWvImJUWkBIbroCBbD3aiYH0XXn6BkW/6nWgfa9VyYIG75bDBZ9bg6VQKpKUCnt+BnQN49B5Wd/QAj8tgsPbfPws8/Bp+HqUM/cDFQpwlgS3TMLriZb/X4QCP7amkJM5zUXDBEGnO+iCkxr8rTyJN4NkZ0FwOHbdhcx8iQ7B/7C0AR2JDqvuTouezmbk7oX9OrU59NgvzcXNldd+FF/eSd+kxv1UIvfehNBeiC3jIOMNozNPV/MY1eNcARTnQNQf9i2bmmuZBqqWpFN7WwK/fJMv3Y0wPkJMJiU5XKaZb5+L2KgLtVfB1A+rH9KQa61w6tDiq13rQQSCs422GDhWgK5stNsuLTkVH+TkfbJ7nEsQ5DvwkEinscWCw8d9EbTOWVKYgAirzRWZ4oE3kZiA7VLrS3qGyR/9rhwatFB97syyXBP4Xec8Ry9TpbfEAAAAASUVORK5CYII=")},ht.prototype.handler=at,tt("RetryEdge",ht);const mt=function(){};mt.prototype.type="Catch",mt.prototype.create=function(t,e,r,a,n){null==t&&(t=this.type),a||(a={});var o=st(this,t,"endArrow=classic;html=1;strokeColor=#000000;strokeWidth=1;fontSize=12;",e,r);return o.setAttribute("placeholders",1),o.setAttribute("error_equals",a.ErrorEquals||""),o.setAttribute("result_path",a.ResultPath||""),o.setAttribute("weight",n||"1"),o},mt.prototype.validate=function(t,e){return e||(e=[]),t.source&&t.target||e.push("edge MUST be connected"),0==S(t.getAttribute("result_path"))&&e.push("result_path MUST use only supported jsonpath"),e},mt.prototype.expJSON=function(t,e){var r=t.getAttribute("error_equals");if(r=r?r.split(/,\s*/):[],null!=t.target){var a={ErrorEquals:r,Next:e[t.target.id].getAttribute("label")};return t.getAttribute("result_path")&&(a.ResultPath=M(t.getAttribute("result_path"))),a}return{}},mt.prototype.createHandlerImage=function(){return v.call(this,mt,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAACFklEQVRIS7WVT0hUURTGf5NRbsRZBLlImHZKwRREM2Cg48YWoRNE2SIq3BSloxudTToqkUXguBSCDEFsETMtRmqlxSi2CLIg3ESDDEOhlOJmimDi+Ob5/t2Z8RXe1Xv3nfed737nu+d4CoVCgX1anj2Bb2bg+wp8+wB1p+CoH7y+ipRKg+c34XUfrCZBnu2r2gsNYWgbB3lWLDW4AL68qQZVJel4qiWyLSd48gasPKt4ZEdAIALn45ZtK7gwfn7RPbD+x5WE5QQGuOg6cdwpxekuCEbgSCMcOAh/8rCWhvl7kF22EhHtI193a2CAq+Rova8BZ9/B21HIvdfeRYLtHLy4CuufrQn81yE8tbNngI954deWEXgsCJdm4ccXmA3D723jW2gEznbDchzeDDvZD/w0gYuPRRLzah6EYB+kH8DiI3d1EGm8viJzVSHbn8CJy5C6Ax+n3YEXC6vJshBzHu/CJJzshLm77sGbh6AlVoZ5Uz80DcDiQ6csh2rgXBQ2VtWJLcxVmpcraKAHQqPwaQZSt52SWTSXz3a3yJ7ZikuPNX/rVpR7kbjm9PrhWohqvai8zyVCpDlzC2rrwVNV/hJJvNLnwiTus3rdnUdAWPdmFDdUgPatt+gs/7UrFu1nPmzpfi5JzO2glEQihfSSPfVzHURq8KpXk0qVREAFUHq4q0lkZyn3QOanPkNljv7XDHXrFEX8X1YGE8t/bBUwAAAAAElFTkSuQmCC")},mt.prototype.handler=at,tt("CatchEdge",mt);const gt=function(){};gt.prototype.type="Choice",gt.prototype.create=function(t,e,r,a,n){null==t&&(t=this.type),a||(a={});var o=st(this,t,"endArrow=classic;html=1;strokeColor=#000000;strokeWidth=1;fontSize=12;",e,r);return o.setAttribute("placeholders",1),o.setAttribute("condition",function t(e){var r=e.Variable,a={And:"&&",Or:"||",Equals:"==",GreaterThan:">",GreaterThanEquals:">=",LessThan:"<",LessThanEquals:"<="};for(var n in e){var o=e[n];if(n.match(/^(And|Or)$/))return o.map(e=>"("+t(e)+")").join(" "+a[n]+" ");if(n.match(/^(Not)$/))return"!("+t(o)+")";{const t=n.match(/^(Boolean|Numeric|String|Timestamp)(Equals|GreaterThan|GreaterThanEquals|LessThan|LessThanEquals)$/);if(t)return t[1].match(/(String|Timestamp)/i)?[r,a[t[2]],'"'+o+'"'].join(" "):[r,a[t[2]],o].join(" ")}}}(a)||"$.foo == 1"),o.setAttribute("weight",n||"1"),o},gt.prototype.validate=function(t,e){e||(e=[]),t.source&&t.target||e.push("edge MUST be connected");var r=t.getAttribute("condition");if(r)try{jsep(r)}catch(t){e.push("invalid jsep.")}else e.push("condition MUST be defined");return e},gt.prototype.expJSON=function(t,e){if(null!=t.target){var r,a=t.getAttribute("condition");if(null!=a)r=T(jsep(a));return r.Next=e[t.target.id].getAttribute("label"),r}return{}},gt.prototype.createHandlerImage=function(){return v.call(this,gt,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAACWUlEQVRIS7WVXW/SUBjH/12AGZDSDkkwQ40mytCxmC1z6Fx82RUXiiYz8WvMO/0AXrqPoYkandF4t+iWuSXTRMkcu1OUKbFAAWFCy1ZzaoCe9oDUl3PV5pzzO8/L/3keTtM0DV1WsdpAVlaRLSoICi4ERScEj6PbldYex4LX1F08fyNjM7MN8m1ee5x9GAq5ER8TQb47LQs8ldnG49U8E8p65ErMj0jIzeRT8EerObz9UO3JZeOhWNiL+OiA5V4LTiy+tyTZBjcvXJ8KWDzQ4SSuc/NbllCMHtmLWJhHwOdEHwc0djSkpToWkkVk8nXKEBL72cQglQMdzgrH9Iiggwnk5XoJXwp1/f90mMf3Hzu4vyxBKqvUAycPe3A1to9Wy+0Hn1BX24oM+ftxbTKAQkXF3cVvUBrtvYtRARNhL1Y2y3ixXrJYf3PmQBsuV1Rt7skWdejcsA9nhngsvi9hOVW2lYfZy4OtOuA2Plc1cyITp/w4cciDZ2t5vPtoTz3GxHILSVkzu3dp3I8ogb+2Dz8/7MOFqKB7y7R8MsJj6rgPSxvWsLgcnL6XK6tMryjLWTHvltCJY15Mj4hIpit4ulaw5IOKOZGiWS3khlGKr1JlpKVaS4o1ZRcPV3IWrfc7OdyaOUhLsVPZn43wGD/qBe92/LaICJGpc1Khd+YzlNZt6Q8AsfpGImStUAL6b72laeWfdkWj/IweM/s5ecTYDjqFiISC9JKe+nkT8msSFfRQsR4hUAKMjw3Ym0RmK8kM/SoryMoKgqIL+0XX381Qu0rpeYb+KzDh/AQ2ZmDL5ziOTgAAAABJRU5ErkJggg==")},gt.prototype.handler=at,tt("ChoiceEdge",gt);const ft=function(){};ft.prototype.type="Default",ft.prototype.create=function(t,e,r){return null==t&&(t=this.type),st(this,t,"endArrow=classic;html=1;strokeColor=#000000;strokeWidth=1;fontSize=12;",e,r)},ft.prototype.validate=function(t,e){return e||(e=[]),t.source&&t.target||e.push("edge MUST be connected"),e},ft.prototype.expJSON=function(t,e){return null!=t.target?{Default:e[t.target.id].getAttribute("label")}:{}},ft.prototype.createHandlerImage=function(){return v.call(this,ft,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAYCAYAAAARfGZ1AAABsklEQVRIS9WVO0sDQRDH/9ek0YAQsEgQFCRpxCaKmuoOQRtN7aOxEVtBP0B8gCARrESwsdI+WoggHkGDoH6ABPGJdhYaEY3Fyma53L5yXoIRHLjmduY3s/PYMQghBB5SfAKeC+wLRdkXDHtZuGeGDl4qArk14NYGSm8qKNAMtJtAYg4IBKs7UuAUaKf0UBlDnZgp5kgnApxCC/v+rsxrdY0BiXnVrgKnER9qFPy6GkqrNyjDaY53Rt1UhHsAaxFoauXQBPgsAndZ4HQV+HoX3dIUTeyJNSjD5XQ48IcckF1mkJYOoHsS6BwGro9YXWSJjrAaOFKGb5tiAXVwx8BaAtoGgFwauDpQo5+yOfjrIyG7SVHJCx5LAv2zQD4DnK2r0Y9n3Dkwbo4JkQvpBfc6o674whoXm4RcbvmPPNIHWAvA/YlbD946Pg3EZ9ifmiP/KS1C5LXmfHAFiPSyqOlsyCLk3G+3+GlF2utCt3j1uTxEHy+s/c431CGiN9D2uTyhfkee16s6oVSpYW+LE0G9ryLffvxt/u49d7w2bBPJxazs0DwQiv3CDq2nW3Q22gX9L+Df4kMPyOkzB4MAAAAASUVORK5CYII=")},ft.prototype.handler=at,tt("DefaultEdge",ft);const bt=function(){};bt.prototype.type="Fail",bt.prototype.create=function(t,e){e||(e={});var r=nt(this,t,"shape=mxgraph.flowchart.terminator;html=1;whiteSpace=wrap;gradientColor=none;",e);return r.setAttribute("error",e.Error||""),r.setAttribute("cause",e.Cause||""),r.value.removeAttribute("input_path"),r.value.removeAttribute("output_path"),r},bt.prototype.validate=function(t,e){return e||(e=[]),t.edges&&t.edges.filter((function(e){return e.source==t&&o(e)})).length>0&&e.push("A Fail state MUST have no outgoing edge"),t.getAttribute("error")||e.push("error MUST have a value"),t.getAttribute("cause")||e.push("cause MUST have a value"),E(t,e,!1)},bt.prototype.expJSON=function(t,e){var r={},a=t.getAttribute("label");return r[a]={Type:"Fail",Error:t.getAttribute("error"),Cause:t.getAttribute("cause")},t.getAttribute("comment")&&(r[a].Comment=t.getAttribute("comment")),r},tt("FailState",bt),bt.prototype.handler=rt;const At=function(){};At.prototype.type="Parallel",At.prototype.create=function(t,e){e||(e={});var r=nt(this,t,"swimlane;whiteSpace=wrap;html=1;dashed=1;gradientColor=none",e),a=r.getGeometry();r.setGeometry(new mxGeometry(a.x,a.y,480,200)),r.setAttribute("branches","");var n=StartPoint.prototype.create(new mxGeometry((r.geometry.width-30)/2,40,30,30));if(r.insert(n),0===Object.keys(e).length){var o=TaskState.prototype.create();o.setGeometry(new mxGeometry(80,80,o.geometry.width,o.geometry.height)),r.insert(o);var s=StartAtEdge.prototype.create("StartAt",n,o);r.insert(s);var i=TaskState.prototype.create();i.setGeometry(new mxGeometry(320,80,i.geometry.width,i.geometry.height)),r.insert(i);var u=StartAtEdge.prototype.create("StartAt",n,i);r.insert(u)}return r},At.prototype.hiddenAttributes=["branches"],At.prototype.createDefaultEdge=function(t){for(var e in t.edges){var r=t.edges[e];if(r.source==t&&m(r))return CatchEdge.prototype.create()}return NextEdge.prototype.create()},At.prototype.validate=function(t,e){return e||(e=[]),0==x(t.getAttribute("parameters"))&&e.push("parameters MUST be valid JSON"),E(t,e,!0)},At.prototype.expJSON=function(t,e){const r={},a=t.getAttribute("label");r[a]={Type:"Parallel",Branches:[]},t.getAttribute("parameters")&&(r[a].Parameters=JSON.parse(t.getAttribute("parameters"))),t.getAttribute("comment")&&(r[a].Comment=t.getAttribute("comment")),t.getAttribute("input_path")&&(r[a].InputPath=M(t.getAttribute("input_path"))),t.getAttribute("output_path")&&(r[a].OutputPath=M(t.getAttribute("output_path"))),t.getAttribute("result_path")&&(r[a].ResultPath=M(t.getAttribute("result_path")));const n=[];for(const r of t.children)if(i(r))for(const t of r.edges)t.target!=r&&g(t)&&n.push(e[t.target.id]);function s(t,r){for(var a in r.push(t),t.edges){var n=t.edges[a];n.target!=t&&s(e[n.target.id],r)}return r}for(const l of n){const n=[];s(l,n);const c={};for(const r of n)if(null!=r.value&&"object"==typeof r.value&&o(r)&&!i(r)&&!u(t)&&r.isVertex()){if(p(r))continue;r.awssf&&r.awssf.expJSON&&Object.assign(c,r.awssf.expJSON(r,e))}r[a].Branches.push({StartAt:l.getAttribute("label"),States:c})}let l=!1;if(t.edges){const n=t.edges.sort((function(t,e){return Number(t.getAttribute("weight"))>Number(e.getAttribute("weight"))?-1:Number(t.getAttribute("weight"))<Number(e.getAttribute("weight"))?1:0}));for(const o of n)o.source==t&&o.awssf.expJSON&&(f(o)?(r[a].Retry||(r[a].Retry=[]),r[a].Retry.push(o.awssf.expJSON(o,e))):b(o)?(r[a].Catch||(r[a].Catch=[]),r[a].Catch.push(o.awssf.expJSON(o,e))):m(o)&&(l=!0,Object.assign(r[a],o.awssf.expJSON(o,e))))}return 0!=l&&"End"!=r[a].Next||(delete r[a].Next,r[a].End=!0),r},tt("ParallelState",At);var yt=function(t){this.custom=function(){this.domNode.appendChild(NextEdge.prototype.createHandlerImage.apply(this,arguments)),this.domNode.appendChild(CatchEdge.prototype.createHandlerImage.apply(this,arguments)),this.domNode.appendChild(RetryEdge.prototype.createHandlerImage.apply(this,arguments))},rt.apply(this,arguments)};At.prototype.handler=yt,mxUtils.extend(yt,rt);const vt=function(){};vt.prototype.type="Pass",vt.prototype.create=function(t,e){e||(e={});var r=nt(this,t,"shape=mxgraph.flowchart.process;whiteSpace=wrap;gradientColor=none;html=1;",e);return r.setAttribute("parameters",JSON.stringify(e.Parameters)||""),r.value.setAttribute("result",e.Result||""),r.value.setAttribute("result_path",e.ResultPath||""),r},vt.prototype.createDefaultEdge=function(t){for(var e in t.edges){var r=t.edges[e];if(r.source==t&&m(r))return null}return NextEdge.prototype.create()},vt.prototype.validate=function(t,e){return e||(e=[]),0==x(t.getAttribute("parameters"))&&e.push("parameters MUST be valid JSON"),E(t,e,!0)},vt.prototype.expJSON=function(t,e){var r={},a=t.getAttribute("label");r[a]={Type:"Pass"},t.getAttribute("parameters")&&(r[a].Parameters=JSON.parse(t.getAttribute("parameters"))),t.getAttribute("comment")&&(r[a].Comment=t.getAttribute("comment")),t.getAttribute("input_path")&&(r[a].InputPath=M(t.getAttribute("input_path"))),t.getAttribute("output_path")&&(r[a].OutputPath=M(t.getAttribute("output_path"))),t.getAttribute("result_path")&&(r[a].ResultPath=M(t.getAttribute("result_path"))),t.getAttribute("result")&&(r[a].Result=t.getAttribute("result"));var n=!1;for(var o in t.edges){var s=t.edges[o];s.source==t&&(m(s)&&(n=!0,Object.assign(r[a],s.awssf.expJSON(s,e))))}return 0!=n&&"End"!=r[a].Next||(delete r[a].Next,r[a].End=!0),r},tt("PassState",vt);var wt=function(t){this.custom=function(){this.domNode.appendChild(NextEdge.prototype.createHandlerImage.apply(this,arguments))},rt.apply(this,arguments)};vt.prototype.handler=wt,mxUtils.extend(wt,rt);const xt=function(){};xt.prototype.type="Start",xt.prototype.create=function(t){return ot(this,t)},xt.prototype.createDefaultEdge=function(){return StartAtEdge.prototype.create()},tt("StartPoint",xt);const St=function(){};St.prototype.type="End",St.prototype.create=function(){return ot(this)},tt("EndPoint",St);const Et=function(){};Et.prototype.type="Succeed",Et.prototype.create=function(t,e){e||(e={});return nt(this,t,"shape=mxgraph.flowchart.terminator;html=1;whiteSpace=wrap;gradientColor=none;",e)},Et.prototype.validate=function(t,e){return e||(e=[]),t.edges&&t.edges.filter((function(e){return e.source==t&&o(e)})).length>0&&e.push("A Succeed state MUST have no outgoing edge"),E(t,e,!1)},Et.prototype.expJSON=function(t,e){var r={},a=t.getAttribute("label");return r[a]={Type:"Succeed"},t.getAttribute("comment")&&(r[a].Comment=t.getAttribute("comment")),t.getAttribute("input_path")&&(r[a].InputPath=M(t.getAttribute("input_path"))),t.getAttribute("output_path")&&(r[a].OutputPath=M(t.getAttribute("output_path"))),r},tt("SucceedState",Et),Et.prototype.handler=rt;const Ct=function(){};Ct.prototype.type="Task",Ct.prototype.create=function(t,e){e||(e={});var r=nt(this,t,"shape=stencil(rZVNb4MwDIZ/DdcqkI2P48S6Y1Wph51TMCMqTVDC2m2/fiEBdUCyAavExa+xH78BjIdTWZIavAAxcgYPP3tBsBeQQ0EZ5EreC56BlEpWQWluCJEJryZMYhMSWUPWGO1CBCXHCkxGNoKf4ErzputAWQmCNm0Wbz30pO5pL5xmnDHVhHImB5kfedWMUKZq0YdphjaPBvPZxSaqFeEMDYiBerO508LLaow/D3NYihl66aF/YV4XYvx1mO3iQ0PBiIT8mazdUk8WWBLPhB2Ww/r3foWz5cc4gc13ZoPhVCmujw2nR5Kd3gR/Z7l1RJ0R7cfuem2tC2K0PojIJP3qpgw3kR+FcYSihzhIEuy7hnaMhtOCC/hl5oJWldlDroOvSbueJok+feYXuPmNLH5tbfvqSu1TV3XoLteWHYOp3X0/P4n/L0Oj8js70jWT56tV8/vSwjc=);whiteSpace=wrap;gradientColor=none;html=1;",e);return r.setAttribute("resource",e.Resource||""),r.setAttribute("timeout_seconds",e.TimeoutSeconds||60),r.setAttribute("heartbeat_seconds",e.HeartbeatSeconds||""),r},Ct.prototype.createDefaultEdge=function(t){for(var e in t.edges){var r=t.edges[e];if(r.source==t&&m(r))return CatchEdge.prototype.create()}return NextEdge.prototype.create()},Ct.prototype.validate=function(t,e){return e||(e=[]),t.getAttribute("resource")&&t.getAttribute("resource").match(/^arn:[^:]+:(states|lambda):[^:]*:[^:]*:[^:]+:.+/)||e.push("resource MUST be a URI that uniquely identifies the specific task to execute"),0==x(t.getAttribute("parameters"))&&e.push("parameters MUST be valid JSON"),0==x(t.getAttribute("results_selector"))&&e.push("results_selector MUST be valid JSON"),0==w(t.getAttribute("timeout_seconds"))&&e.push("timeout_seconds MUST be number"),0==w(t.getAttribute("heartbeat_seconds"))?e.push("heartbeat_seconds MUST be number"):Number(t.getAttribute("heartbeat_seconds"))>=Number(t.getAttribute("timeout_seconds"))&&e.push("heartbeat_seconds MUST be smaller than timeout_seconds"),E(t,e,!0)},Ct.prototype.orderedAttributes=["label","type","resource","parameters","results_selector","input_path","output_path","result_path","timeout_seconds","heartbeat_seconds","comment"],Ct.prototype.expJSON=function(t,e){var r,a={},n=t.getAttribute("label");(a[n]={Type:"Task",Resource:t.getAttribute("resource")},t.getAttribute("parameters"))&&((r=t.getAttribute("parameters"))&&("{"===r[0]?"{}"!==r&&(a[n].Parameters=JSON.parse(r)):a[n].Parameters=r));t.getAttribute("results_selector")&&((r=t.getAttribute("results_selector"))&&("{"===r[0]?"{}"!==r&&(a[n].ResultsSelector=JSON.parse(r)):a[n].ResultsSelector=r));t.getAttribute("comment")&&(a[n].Comment=t.getAttribute("comment")),t.getAttribute("input_path")&&(a[n].InputPath=M(t.getAttribute("input_path"))),t.getAttribute("output_path")&&(a[n].OutputPath=M(t.getAttribute("output_path"))),t.getAttribute("result_path")&&(a[n].ResultPath=M(t.getAttribute("result_path"))),t.getAttribute("timeout_seconds")&&(a[n].TimeoutSeconds=Number(t.getAttribute("timeout_seconds"))),t.getAttribute("heartbeat_seconds")&&(a[n].HeartbeatSeconds=Number(t.getAttribute("heartbeat_seconds")));var o=!1;if(t.edges){var s=t.edges.sort((function(t,e){return Number(t.getAttribute("weight"))>Number(e.getAttribute("weight"))?-1:Number(t.getAttribute("weight"))<Number(e.getAttribute("weight"))?1:0}));for(var i in s){var u=s[i];u.source==t&&(u.awssf&&u.awssf.expJSON&&(f(u)?(a[n].Retry||(a[n].Retry=[]),a[n].Retry.push(u.awssf.expJSON(u,e))):b(u)?(a[n].Catch||(a[n].Catch=[]),a[n].Catch.push(u.awssf.expJSON(u,e))):m(u)&&(o=!0,Object.assign(a[n],u.awssf.expJSON(u,e)))))}}return 0!=o&&"End"!=a[n].Next||(delete a[n].Next,a[n].End=!0),a},tt("TaskState",Ct);var Nt=function(t){this.custom=function(){this.domNode.appendChild(NextEdge.prototype.createHandlerImage.apply(this,arguments)),this.domNode.appendChild(CatchEdge.prototype.createHandlerImage.apply(this,arguments)),this.domNode.appendChild(RetryEdge.prototype.createHandlerImage.apply(this,arguments))},rt.apply(this,arguments)};Ct.prototype.handler=Nt,mxUtils.extend(Nt,rt);const Tt=function(){};Tt.prototype.type="Wait",Tt.prototype.create=function(t,e){e||(e={});var r=nt(this,t,"shape=mxgraph.flowchart.delay;whiteSpace=wrap;gradientColor=none;html=1;",e),a=!1,n=Tt.prototype.cst.DURATION_FORMAT;for(var o in n){var s=C(n[o]);e[n[o]]?(r.setAttribute(s,e[n[o]]),a=!0):r.value.removeAttribute(s)}return a||r.setAttribute("seconds",""),r},Tt.prototype.createDefaultEdge=function(t){for(var e in t.edges){var r=t.edges[e];if(r.source==t&&m(r))return null}return NextEdge.prototype.create()},Tt.prototype.cst={DURATION_FORMAT:["Seconds","SecondsPath","Timestamp","TimestampPath"]},Tt.prototype.validate=function(t,e){var r;return e||(e=[]),0==w(t.getAttribute("seconds"))&&e.push("seconds MUST be number"),0==((r=t.getAttribute("timestamp"))?!!r.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(Z|[+-]\d{2}:\d{2})$/):null)&&e.push("timestamp MUST be valid formated"),0==S(t.getAttribute("seconds_path"))&&e.push("second_path MUST use only supported jsonpath"),0==S(t.getAttribute("timestamp_path"))&&e.push("timestamp_path MUST use only supported jsonpath"),t.getAttribute("seconds")||t.getAttribute("timestamp")||t.getAttribute("seconds_path")||t.getAttribute("timestamp_path")||e.push("A Wait state MUST contain exactly one of ”Seconds”, “SecondsPath”, “Timestamp”, or “TimestampPath”"),E(t,e,!1)},Tt.prototype.expJSON=function(t,e){var r={},a=t.getAttribute("label");r[a]={Type:"Wait"},t.getAttribute("comment")&&(r[a].Comment=t.getAttribute("comment")),t.getAttribute("input_path")&&(r[a].InputPath=M(t.getAttribute("input_path"))),t.getAttribute("output_path")&&(r[a].OutputPath=M(t.getAttribute("output_path")));var n=this.cst.DURATION_FORMAT;for(var o in n){var s=C(n[o]);if(t.getAttribute(s)){t.getAttribute(s).match(/^\d+/)?r[a][n[o]]=Number(t.getAttribute(s)):r[a][n[o]]=t.getAttribute(s);break}}var i=!1;for(var u in t.edges){var l=t.edges[u];l.source==t&&(m(l)&&(i=!0,Object.assign(r[a],l.awssf.expJSON(l,e))))}return 0!=i&&"End"!=r[a].Next||(delete r[a].Next,r[a].End=!0),r},Tt.prototype.buildForm=function(t,e,r){if(-1==["label","comment","input_path","output_path"].indexOf(e)){var a=document.createElement("tr"),n=document.createElement("td"),o=document.createElement("select"),s=this.cst.DURATION_FORMAT;for(var i in s){var u=document.createElement("option");mxUtils.writeln(u,s[i]),u.setAttribute("value",C(s[i])),e==C(s[i])&&u.setAttribute("selected","true"),o.appendChild(u)}n.appendChild(o),a.appendChild(n),n=document.createElement("td");const l=document.createElement("textarea");return l.setAttribute("rows","2"),l.style.width="100%",l.value=r,n.appendChild(l),a.appendChild(n),t.body.appendChild(a),[o,l]}if("placeholders"!=e){const a=t.addTextarea(e+":",r,2);return a.style.width="100%",[e,a]}return null},Tt.prototype.applyForm=function(t,e,r){var a=!1;if(null==r)t.removeAttribute(e);else{if("object"==typeof e)for(var n in this.cst.DURATION_FORMAT){var o=C(this.cst.DURATION_FORMAT[n]);o==e.value?t.setAttribute(e.value,r.value):t.removeAttribute(o)}else t.setAttribute(e,r.value);a=a||"placeholder"==e&&"1"==t.getAttribute("placeholders")}return a},tt("WaitState",Tt);var Mt=function(t){this.custom=function(){this.domNode.appendChild(NextEdge.prototype.createHandlerImage.apply(this,arguments))},rt.apply(this,arguments)};Tt.prototype.handler=Mt,mxUtils.extend(Mt,rt);const Rt=function(){};Rt.prototype.type="Map",Rt.prototype.create=function(t,e){e||(e={});var r=nt(this,t,"swimlane;whiteSpace=wrap;html=1;dashed=1;gradientColor=none;shape=awssf.layered;dx=10;container=1;recursiveResize=0",e),a=r.getGeometry();r.setGeometry(new mxGeometry(a.x,a.y,300,200)),r.setAttribute("items_path",e.ItemsPath||""),r.setAttribute("max_concurrency",e.MaxConcurrency||""),r.setAttribute("iterator","");var n=StartPoint.prototype.create(new mxGeometry((r.geometry.width-30)/2,40,30,30));return r.insert(n),r},Rt.prototype.hiddenAttributes=["iterator"],Rt.prototype.createDefaultEdge=function(t){for(var e in t.edges){var r=t.edges[e];if(r.source==t&&m(r))return CatchEdge.prototype.create()}return NextEdge.prototype.create()},Rt.prototype.validate=function(t,e){return e||(e=[]),0==x(t.getAttribute("parameters"))&&e.push("parameters MUST be valid JSON"),E(t,e,!0)},Rt.prototype.expJSON=function(t,e){const r={},a=t.getAttribute("label");let n;r[a]={Type:"Map",Iterator:{}},t.getAttribute("parameters")&&(r[a].Parameters=JSON.parse(t.getAttribute("parameters"))),t.getAttribute("results_selector")&&(r[a].ResultSelector=JSON.parse(t.getAttribute("results_selector"))),t.getAttribute("comment")&&(r[a].Comment=t.getAttribute("comment")),t.getAttribute("input_path")&&(r[a].InputPath=M(t.getAttribute("input_path"))),t.getAttribute("output_path")&&(r[a].OutputPath=M(t.getAttribute("output_path"))),t.getAttribute("result_path")&&(r[a].ResultPath=M(t.getAttribute("result_path"))),t.getAttribute("items_path")&&(r[a].ItemsPath=M(t.getAttribute("items_path"))),t.getAttribute("max_concurrency")&&(r[a].MaxConcurrency=Number(t.getAttribute("max_concurrency")));for(const r in t.children){const a=t.children[r];if(i(a))for(const t in a.edges){const r=a.edges[t];r.target!=a&&(g(r)&&(n=e[r.target.id]))}}const s=[];!function t(r,a){a.push(r);for(const n in r.edges){const o=r.edges[n];o.target!=r&&t(e[o.target.id],a)}return a}(n,s);const l={};for(const r of s)if(null!=r.value&&"object"==typeof r.value&&o(r)&&!i(r)&&!u(t)&&r.isVertex()){if(d(r))continue;r.awssf&&r.awssf.expJSON&&Object.assign(l,r.awssf.expJSON(r,e))}r[a].Iterator={StartAt:n.getAttribute("label"),States:l};let c=!1;if(t.edges){var p=t.edges.sort((function(t,e){return Number(t.getAttribute("weight"))>Number(e.getAttribute("weight"))?-1:Number(t.getAttribute("weight"))<Number(e.getAttribute("weight"))?1:0}));for(const n in p){const o=p[n];o.source==t&&(o.awssf.expJSON&&(f(o)?(r[a].Retry||(r[a].Retry=[]),r[a].Retry.push(o.awssf.expJSON(o,e))):b(o)?(r[a].Catch||(r[a].Catch=[]),r[a].Catch.push(o.awssf.expJSON(o,e))):m(o)&&(c=!0,Object.assign(r[a],o.awssf.expJSON(o,e)))))}}return 0!=c&&"End"!=r[a].Next||(delete r[a].Next,r[a].End=!0),r},tt("MapState",Rt);var Ot=function(t){this.custom=function(){this.domNode.appendChild(NextEdge.prototype.createHandlerImage.apply(this,arguments)),this.domNode.appendChild(CatchEdge.prototype.createHandlerImage.apply(this,arguments)),this.domNode.appendChild(RetryEdge.prototype.createHandlerImage.apply(this,arguments))},rt.apply(this,arguments)};function Ut(t){!function(t){Z=t,t.editor?t.editor.graph:t.graph}(t),window.AWSconfig=ut,window.ChoiceState=lt,window.FailState=bt,window.ParallelState=At,window.MapState=Rt,window.PassState=vt,window.StartPoint=xt,window.EndPoint=St,window.SucceedState=Et,window.TaskState=Ct,window.WaitState=Tt,window.StartAtEdge=pt,window.NextEdge=dt,window.RetryEdge=ht,window.CatchEdge=mt,window.ChoiceEdge=gt,window.DefaultEdge=ft}Rt.prototype.handler=Ot,mxUtils.extend(Ot,rt);var kt,Pt;r(1);mxscript("https://cdn.jsdelivr.net/npm/jsep@0.3.4/build/jsep.min.js"),mxscript("https://cdn.jsdelivr.net/npm/js-yaml@3.13.1/dist/js-yaml.min.js"),mxscript("https://sdk.amazonaws.com/js/aws-sdk-2.510.0.min.js"),mxscript("https://cdn.jsdelivr.net/npm/jsoneditor@7.0.4/dist/jsoneditor.min.js"),kt="https://cdn.jsdelivr.net/npm/jsoneditor@7.0.4/dist/jsoneditor.min.css",(Pt=document.createElement("link")).setAttribute("rel","stylesheet"),Pt.setAttribute("href",kt),document.getElementsByTagName("head")[0].appendChild(Pt),Draw.loadPlugin((function(t){a=t,function(){const t=EditDataDialog;EditDataDialog=function(e,r){if(!o(r))return t.apply(this,arguments);var a=document.createElement("div"),n=e.editor?e.editor.graph:e.graph;a.style.height="100%",a.style.overflow="auto";var s=n.getModel().getValue(r);if(!mxUtils.isNode(s)){var i=mxUtils.createXmlDocument().createElement("object");i.setAttribute("label",s||""),s=i}var u=new mxForm("properties");u.table.style.width="100%",u.table.style.paddingRight="20px";var l=document.createElement("colgroup");l.width="120",u.table.insertBefore(l,u.body);var c=document.createElement("colgroup");u.table.insertBefore(c,u.body);var p=[];if(r.awssf.orderedAttributes){r.awssf.orderedAttributes.forEach(t=>{p.push(s.attributes.getNamedItem(t))});for(const t of s.attributes)-1===r.awssf.orderedAttributes.indexOf(t.nodeName)&&p.push(t)}else p.push(...s.attributes);for(var d=[],h=[],m=0,g=function(t,e,r){return d[t]=e,h[t]=u.addTextarea(d[m]+":",r,2),h[t].style.width="100%",h[t]},y=function(t,e,r){return d[t]=e,h[t]=u.addText(d[m]+":",r),h[t].style.width="100%",h[t]},v=function(t,e,r,a){d[t]=e;const n=document.createElement("div");n.id="jsoneditor",n.className=e;const o={mode:"code",modes:["code","tree"],statusBar:!1,modalAnchor:n,popupAnchor:n};a&&(o.autocomplete=a);const s={ed:new JSONEditor(n,o),set value(t){try{"{"===t[0]?this.ed.set(JSON.parse(t)):t.length>0&&this.ed.set(t)}catch(e){this.ed.set(t)}},get value(){return"object"==typeof this.ed.get()?JSON.stringify(this.ed.get()):this.ed.get()}};return s.value=r,h[t]=s,u.addField(d[m]+":",n)},w=0;w<p.length;w++){var x=p[w].nodeName,S=p[w].nodeValue;if(!(r.awssf.hiddenAttributes&&r.awssf.hiddenAttributes.indexOf(x)>=0))if("type"==x){var E=document.createElement("span");mxUtils.write(E,S),u.addField("type:",E)}else if("object"==typeof AWS&&"resource"==x){const t=y(m,x,S);m++,t.setAttribute("list","resources");const e=document.createElement("datalist");e.id="resources",D((function(t){for(var r in t){var a=document.createElement("option");a.value=t[r],e.appendChild(a)}})),a.appendChild(e)}else if("label"==x&&(A(r)||f(r)||b(r))){const t=y(m,x,S);m++,t.setAttribute("list","candidates");const e=document.createElement("datalist");e.id="candidates";var C=[];for(var N in p.error_equals&&C.push("%error_equals%"),p.condition&&C.push("%condition%"),C){var T=document.createElement("option");T.value=C[N],e.appendChild(T)}a.appendChild(e)}else if("error_equals"==x){const t=y(m,x,S);m++,t.setAttribute("list","errors");const e=document.createElement("datalist");e.id="errors";var M=["States.ALL","States.Timeout","States.TaskFailed","States.Permissions","States.ResultPathMatchFailure","States.ParameterPathFailure","States.BranchFailed","States.NoChoiceMatched"];for(const t of M){const r=document.createElement("option");r.value=t,e.appendChild(r)}a.appendChild(e)}else if(r.awssf&&r.awssf.buildForm){const t=r.awssf.buildForm(u,x,S);null!=t&&(d[m]=t[0],h[m]=t[1],m++)}else if("parameters"==x){v(m,x,S,{applyTo:["value"],filter:"start",trigger:"focus",getOptions:function(t,e,r,a){return new Promise((function(t,a){if(""!==e[0])return a();if("field"!==r)return a();const n=$("input[list='resources']")[0].value;if(!n)return a();const o=_[n.replace(/\.[^.]+$/,"")];return 0===o.length?a():t(o)}))}}),m++}else"placeholders"!=x&&(g(m,x,S),m++)}a.appendChild(u.table),this.init=function(){h.length>0&&h[0].focus()};var R=mxUtils.button(mxResources.get("cancel"),(function(){e.hideDialog.apply(e,arguments)}));R.className="geBtn";var O=mxUtils.button(mxResources.get("apply"),(function(){try{e.hideDialog.apply(e,arguments),s=s.cloneNode(!0);for(var t=!1,a=0;a<d.length;a++)r.awssf&&r.awssf.applyForm?t=t||r.awssf.applyForm(s,d[a],h[a]):null==h[a]?s.removeAttribute(d[a]):(s.setAttribute(d[a],h[a].value),t=t||"placeholder"==d[a]&&"1"==s.getAttribute("placeholders"));t&&s.removeAttribute("label"),n.getModel().setValue(r,s)}catch(t){mxUtils.alert(t)}}));O.className="geBtn gePrimaryBtn";var U=document.createElement("div");if(U.style.marginTop="18px",U.style.textAlign="right",n.getModel().isVertex(r)||n.getModel().isEdge(r)){var k=document.createElement("span");k.style.marginRight="10px";var P=document.createElement("input");if(P.setAttribute("type","checkbox"),P.style.marginRight="6px","1"==s.getAttribute("placeholders")&&(P.setAttribute("checked","checked"),P.defaultChecked=!0),mxEvent.addListener(P,"click",(function(){"1"==s.getAttribute("placeholders")?s.removeAttribute("placeholders"):s.setAttribute("placeholders","1")})),k.appendChild(P),mxUtils.write(k,mxResources.get("placeholders")),null!=EditDataDialog.placeholderHelpLink){var I=document.createElement("a");I.setAttribute("href",EditDataDialog.placeholderHelpLink),I.setAttribute("title",mxResources.get("help")),I.setAttribute("target","_blank"),I.style.marginLeft="10px",I.style.cursor="help";var B=document.createElement("img");B.setAttribute("border","0"),B.setAttribute("valign","middle"),B.style.marginTop="-4px",B.setAttribute("src",Editor.helpImage),I.appendChild(B),k.appendChild(I)}U.appendChild(k)}e.editor&&e.editor.cancelFirst?(U.appendChild(R),U.appendChild(O)):(U.appendChild(O),U.appendChild(R)),a.appendChild(U),this.container=a}}(),Ut(t),function(t){const e=t.sidebar;e.addPalette("awsStepFunctions","AWS Step Functions",!0,(function(t){const r=[AWSconfig,StartPoint,EndPoint,TaskState,PassState,ChoiceState,WaitState,SucceedState,FailState,ParallelState,MapState];for(const a of r){const r=a.prototype.create();t.appendChild(e.createVertexTemplateFromCells([r],r.geometry.width,r.geometry.height,r.label))}}));const r=e.container;r.firstChild.click(),r.insertBefore(r.lastChild,r.firstChild),r.insertBefore(r.lastChild,r.firstChild)}(t),function(t){J=t,mxResources.parse("stepFunctions=StepFunctions"),mxResources.parse("awssfValidate=Validate"),mxResources.parse("awssfImport=Import..."),mxResources.parse("awssfImportBtn=Import"),mxResources.parse("awssfExportJSON=Export JSON"),mxResources.parse("awssfExportYAML=Export YAML"),mxResources.parse("awssfExport=Export"),mxResources.parse("awssfLambda=Lambda"),mxResources.parse("awssfDeploy=Deploy..."),mxResources.parse("awssfDeployBtn=Deploy"),t.actions.addAction("editData...",F,null,null,"Ctrl+M"),t.actions.addAction("awssfValidate",H),t.actions.addAction("awssfExportJSON",V),t.actions.addAction("awssfExportYAML",W),t.actions.addAction("awssfExport",Y),t.actions.addAction("awssfImport",q),t.actions.addAction("awssfDeploy",G).isEnabled=O;var e=t.menubar.addMenu("StepFunctions",(function(e,r){t.menus.addMenuItems(e,["-","awssfValidate","-","awssfImport","awssfExportJSON","awssfExportYAML","awssfExport","-","awssfDeploy"])}));e.parentNode.insertBefore(e,e.previousSibling.previousSibling.previousSibling)}(t),function(t){t.addListener("clientLoaded",(function(...e){console.log(">>reload scratchpad",...e),t.toggleScratchpad(),t.toggleScratchpad()}))}(t),Q(t)}))}]);